{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":42,"index":191}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    const [activeRole, setActiveRoleState] = (0, _react.useState)(null);\n    const [isInitialized, setIsInitialized] = (0, _react.useState)(false);\n    (0, _react.useEffect)(() => {\n      loadUser();\n    }, []);\n    const loadUser = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('auth_token');\n        const savedRole = await AsyncStorage.default.getItem('active_role');\n        if (token) {\n          try {\n            const userData = await _servicesApi.authAPI.getMe();\n            setUser(userData);\n            if (savedRole && userData.roles.includes(savedRole)) {\n              setActiveRoleState(savedRole);\n            } else if (userData.roles.length > 0) {\n              setActiveRoleState(userData.roles[0]);\n            }\n          } catch (apiError) {\n            console.error('Error fetching user data:', apiError);\n            await AsyncStorage.default.removeItem('auth_token');\n          }\n        }\n      } catch (error) {\n        console.error('Error loading user:', error);\n      } finally {\n        setLoading(false);\n        setIsInitialized(true);\n      }\n    };\n    const signup = async data => {\n      const response = await _servicesApi.authAPI.signup(data);\n      await AsyncStorage.default.setItem('auth_token', response.access_token);\n      setUser(response.user);\n\n      // Set initial active role\n      if (response.user.roles.length > 0) {\n        const initialRole = response.user.roles[0];\n        setActiveRoleState(initialRole);\n        await AsyncStorage.default.setItem('active_role', initialRole);\n      }\n    };\n    const login = async (email, password) => {\n      const response = await _servicesApi.authAPI.login(email, password);\n      await AsyncStorage.default.setItem('auth_token', response.access_token);\n      setUser(response.user);\n\n      // Set active role\n      const savedRole = await AsyncStorage.default.getItem('active_role');\n      if (savedRole && response.user.roles.includes(savedRole)) {\n        setActiveRoleState(savedRole);\n      } else if (response.user.roles.length > 0) {\n        const initialRole = response.user.roles[0];\n        setActiveRoleState(initialRole);\n        await AsyncStorage.default.setItem('active_role', initialRole);\n      }\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('auth_token');\n      await AsyncStorage.default.removeItem('active_role');\n      setUser(null);\n      setActiveRoleState(null);\n    };\n    const setActiveRole = async role => {\n      if (user && user.roles.includes(role)) {\n        setActiveRoleState(role);\n        await AsyncStorage.default.setItem('active_role', role);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        loading,\n        activeRole,\n        signup,\n        login,\n        logout,\n        setActiveRole\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 5\n    }, this);\n  };\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within AuthProvider');\n    }\n    return context;\n  };\n});","lineCount":129,"map":[[13,2,18,0,"Object"],[13,8,18,0],[13,9,18,0,"defineProperty"],[13,23,18,0],[13,24,18,0,"exports"],[13,31,18,0],[14,4,18,0,"enumerable"],[14,14,18,0],[15,4,18,0,"get"],[15,7,18,0],[15,18,18,0,"get"],[15,19,18,0],[16,6,18,0],[16,13,18,0,"AuthProvider"],[16,25,18,0],[17,4,18,0],[18,2,18,0],[19,2,116,0,"Object"],[19,8,116,0],[19,9,116,0,"defineProperty"],[19,23,116,0],[19,24,116,0,"exports"],[19,31,116,0],[20,4,116,0,"enumerable"],[20,14,116,0],[21,4,116,0,"get"],[21,7,116,0],[21,18,116,0,"get"],[21,19,116,0],[22,6,116,0],[22,13,116,0,"useAuth"],[22,20,116,0],[23,4,116,0],[24,2,116,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,3,0],[28,6,3,0,"_servicesApi"],[28,18,3,0],[28,21,3,0,"require"],[28,28,3,0],[28,29,3,0,"_dependencyMap"],[28,43,3,0],[29,2,3,42],[29,6,3,42,"_reactJsxDevRuntime"],[29,25,3,42],[29,28,3,42,"require"],[29,35,3,42],[29,36,3,42,"_dependencyMap"],[29,50,3,42],[30,2,16,0],[30,8,16,6,"AuthContext"],[30,19,16,17],[30,35,16,20],[30,39,16,20,"createContext"],[30,45,16,33],[30,46,16,33,"createContext"],[30,59,16,33],[30,61,16,63,"undefined"],[30,70,16,72],[30,71,16,73],[31,2,18,7],[31,8,18,13,"AuthProvider"],[31,20,18,66],[31,23,18,69,"AuthProvider"],[31,24,18,70],[32,4,18,72,"children"],[33,2,18,81],[33,3,18,82],[33,8,18,87],[34,4,19,2],[34,10,19,8],[34,11,19,9,"user"],[34,15,19,13],[34,17,19,15,"setUser"],[34,24,19,22],[34,25,19,23],[34,28,19,26],[34,32,19,26,"useState"],[34,38,19,34],[34,39,19,34,"useState"],[34,47,19,34],[34,49,19,48],[34,53,19,52],[34,54,19,53],[35,4,20,2],[35,10,20,8],[35,11,20,9,"loading"],[35,18,20,16],[35,20,20,18,"setLoading"],[35,30,20,28],[35,31,20,29],[35,34,20,32],[35,38,20,32,"useState"],[35,44,20,40],[35,45,20,40,"useState"],[35,53,20,40],[35,55,20,41],[35,59,20,45],[35,60,20,46],[36,4,21,2],[36,10,21,8],[36,11,21,9,"activeRole"],[36,21,21,19],[36,23,21,21,"setActiveRoleState"],[36,41,21,39],[36,42,21,40],[36,45,21,43],[36,49,21,43,"useState"],[36,55,21,51],[36,56,21,51,"useState"],[36,64,21,51],[36,66,21,67],[36,70,21,71],[36,71,21,72],[37,4,22,2],[37,10,22,8],[37,11,22,9,"isInitialized"],[37,24,22,22],[37,26,22,24,"setIsInitialized"],[37,42,22,40],[37,43,22,41],[37,46,22,44],[37,50,22,44,"useState"],[37,56,22,52],[37,57,22,52,"useState"],[37,65,22,52],[37,67,22,53],[37,72,22,58],[37,73,22,59],[38,4,24,2],[38,8,24,2,"useEffect"],[38,14,24,11],[38,15,24,11,"useEffect"],[38,24,24,11],[38,26,24,12],[38,32,24,18],[39,6,25,4,"loadUser"],[39,14,25,12],[39,15,25,13],[39,16,25,14],[40,4,26,2],[40,5,26,3],[40,7,26,5],[40,9,26,7],[40,10,26,8],[41,4,28,2],[41,10,28,8,"loadUser"],[41,18,28,16],[41,21,28,19],[41,27,28,19,"loadUser"],[41,28,28,19],[41,33,28,31],[42,6,29,4],[42,10,29,8],[43,8,30,6],[43,14,30,12,"token"],[43,19,30,17],[43,22,30,20],[43,28,30,26,"AsyncStorage"],[43,40,30,38],[43,41,30,38,"default"],[43,48,30,38],[43,49,30,39,"getItem"],[43,56,30,46],[43,57,30,47],[43,69,30,59],[43,70,30,60],[44,8,31,6],[44,14,31,12,"savedRole"],[44,23,31,21],[44,26,31,24],[44,32,31,30,"AsyncStorage"],[44,44,31,42],[44,45,31,42,"default"],[44,52,31,42],[44,53,31,43,"getItem"],[44,60,31,50],[44,61,31,51],[44,74,31,64],[44,75,31,65],[45,8,33,6],[45,12,33,10,"token"],[45,17,33,15],[45,19,33,17],[46,10,34,8],[46,14,34,12],[47,12,35,10],[47,18,35,16,"userData"],[47,26,35,24],[47,29,35,27],[47,35,35,33,"authAPI"],[47,47,35,40],[47,48,35,40,"authAPI"],[47,55,35,40],[47,56,35,41,"getMe"],[47,61,35,46],[47,62,35,47],[47,63,35,48],[48,12,36,10,"setUser"],[48,19,36,17],[48,20,36,18,"userData"],[48,28,36,26],[48,29,36,27],[49,12,38,10],[49,16,38,14,"savedRole"],[49,25,38,23],[49,29,38,27,"userData"],[49,37,38,35],[49,38,38,36,"roles"],[49,43,38,41],[49,44,38,42,"includes"],[49,52,38,50],[49,53,38,51,"savedRole"],[49,62,38,60],[49,63,38,61],[49,65,38,63],[50,14,39,12,"setActiveRoleState"],[50,32,39,30],[50,33,39,31,"savedRole"],[50,42,39,40],[50,43,39,41],[51,12,40,10],[51,13,40,11],[51,19,40,17],[51,23,40,21,"userData"],[51,31,40,29],[51,32,40,30,"roles"],[51,37,40,35],[51,38,40,36,"length"],[51,44,40,42],[51,47,40,45],[51,48,40,46],[51,50,40,48],[52,14,41,12,"setActiveRoleState"],[52,32,41,30],[52,33,41,31,"userData"],[52,41,41,39],[52,42,41,40,"roles"],[52,47,41,45],[52,48,41,46],[52,49,41,47],[52,50,41,48],[52,51,41,49],[53,12,42,10],[54,10,43,8],[54,11,43,9],[54,12,43,10],[54,19,43,17,"apiError"],[54,27,43,25],[54,29,43,27],[55,12,44,10,"console"],[55,19,44,17],[55,20,44,18,"error"],[55,25,44,23],[55,26,44,24],[55,53,44,51],[55,55,44,53,"apiError"],[55,63,44,61],[55,64,44,62],[56,12,45,10],[56,18,45,16,"AsyncStorage"],[56,30,45,28],[56,31,45,28,"default"],[56,38,45,28],[56,39,45,29,"removeItem"],[56,49,45,39],[56,50,45,40],[56,62,45,52],[56,63,45,53],[57,10,46,8],[58,8,47,6],[59,6,48,4],[59,7,48,5],[59,8,48,6],[59,15,48,13,"error"],[59,20,48,18],[59,22,48,20],[60,8,49,6,"console"],[60,15,49,13],[60,16,49,14,"error"],[60,21,49,19],[60,22,49,20],[60,43,49,41],[60,45,49,43,"error"],[60,50,49,48],[60,51,49,49],[61,6,50,4],[61,7,50,5],[61,16,50,14],[62,8,51,6,"setLoading"],[62,18,51,16],[62,19,51,17],[62,24,51,22],[62,25,51,23],[63,8,52,6,"setIsInitialized"],[63,24,52,22],[63,25,52,23],[63,29,52,27],[63,30,52,28],[64,6,53,4],[65,4,54,2],[65,5,54,3],[66,4,56,2],[66,10,56,8,"signup"],[66,16,56,14],[66,19,56,17],[66,25,56,24,"data"],[66,29,56,33],[66,33,56,38],[67,6,57,4],[67,12,57,10,"response"],[67,20,57,18],[67,23,57,21],[67,29,57,27,"authAPI"],[67,41,57,34],[67,42,57,34,"authAPI"],[67,49,57,34],[67,50,57,35,"signup"],[67,56,57,41],[67,57,57,42,"data"],[67,61,57,46],[67,62,57,47],[68,6,58,4],[68,12,58,10,"AsyncStorage"],[68,24,58,22],[68,25,58,22,"default"],[68,32,58,22],[68,33,58,23,"setItem"],[68,40,58,30],[68,41,58,31],[68,53,58,43],[68,55,58,45,"response"],[68,63,58,53],[68,64,58,54,"access_token"],[68,76,58,66],[68,77,58,67],[69,6,59,4,"setUser"],[69,13,59,11],[69,14,59,12,"response"],[69,22,59,20],[69,23,59,21,"user"],[69,27,59,25],[69,28,59,26],[71,6,61,4],[72,6,62,4],[72,10,62,8,"response"],[72,18,62,16],[72,19,62,17,"user"],[72,23,62,21],[72,24,62,22,"roles"],[72,29,62,27],[72,30,62,28,"length"],[72,36,62,34],[72,39,62,37],[72,40,62,38],[72,42,62,40],[73,8,63,6],[73,14,63,12,"initialRole"],[73,25,63,23],[73,28,63,26,"response"],[73,36,63,34],[73,37,63,35,"user"],[73,41,63,39],[73,42,63,40,"roles"],[73,47,63,45],[73,48,63,46],[73,49,63,47],[73,50,63,48],[74,8,64,6,"setActiveRoleState"],[74,26,64,24],[74,27,64,25,"initialRole"],[74,38,64,36],[74,39,64,37],[75,8,65,6],[75,14,65,12,"AsyncStorage"],[75,26,65,24],[75,27,65,24,"default"],[75,34,65,24],[75,35,65,25,"setItem"],[75,42,65,32],[75,43,65,33],[75,56,65,46],[75,58,65,48,"initialRole"],[75,69,65,59],[75,70,65,60],[76,6,66,4],[77,4,67,2],[77,5,67,3],[78,4,69,2],[78,10,69,8,"login"],[78,15,69,13],[78,18,69,16],[78,24,69,16,"login"],[78,25,69,23,"email"],[78,30,69,36],[78,32,69,38,"password"],[78,40,69,54],[78,45,69,59],[79,6,70,4],[79,12,70,10,"response"],[79,20,70,18],[79,23,70,21],[79,29,70,27,"authAPI"],[79,41,70,34],[79,42,70,34,"authAPI"],[79,49,70,34],[79,50,70,35,"login"],[79,55,70,40],[79,56,70,41,"email"],[79,61,70,46],[79,63,70,48,"password"],[79,71,70,56],[79,72,70,57],[80,6,71,4],[80,12,71,10,"AsyncStorage"],[80,24,71,22],[80,25,71,22,"default"],[80,32,71,22],[80,33,71,23,"setItem"],[80,40,71,30],[80,41,71,31],[80,53,71,43],[80,55,71,45,"response"],[80,63,71,53],[80,64,71,54,"access_token"],[80,76,71,66],[80,77,71,67],[81,6,72,4,"setUser"],[81,13,72,11],[81,14,72,12,"response"],[81,22,72,20],[81,23,72,21,"user"],[81,27,72,25],[81,28,72,26],[83,6,74,4],[84,6,75,4],[84,12,75,10,"savedRole"],[84,21,75,19],[84,24,75,22],[84,30,75,28,"AsyncStorage"],[84,42,75,40],[84,43,75,40,"default"],[84,50,75,40],[84,51,75,41,"getItem"],[84,58,75,48],[84,59,75,49],[84,72,75,62],[84,73,75,63],[85,6,76,4],[85,10,76,8,"savedRole"],[85,19,76,17],[85,23,76,21,"response"],[85,31,76,29],[85,32,76,30,"user"],[85,36,76,34],[85,37,76,35,"roles"],[85,42,76,40],[85,43,76,41,"includes"],[85,51,76,49],[85,52,76,50,"savedRole"],[85,61,76,59],[85,62,76,60],[85,64,76,62],[86,8,77,6,"setActiveRoleState"],[86,26,77,24],[86,27,77,25,"savedRole"],[86,36,77,34],[86,37,77,35],[87,6,78,4],[87,7,78,5],[87,13,78,11],[87,17,78,15,"response"],[87,25,78,23],[87,26,78,24,"user"],[87,30,78,28],[87,31,78,29,"roles"],[87,36,78,34],[87,37,78,35,"length"],[87,43,78,41],[87,46,78,44],[87,47,78,45],[87,49,78,47],[88,8,79,6],[88,14,79,12,"initialRole"],[88,25,79,23],[88,28,79,26,"response"],[88,36,79,34],[88,37,79,35,"user"],[88,41,79,39],[88,42,79,40,"roles"],[88,47,79,45],[88,48,79,46],[88,49,79,47],[88,50,79,48],[89,8,80,6,"setActiveRoleState"],[89,26,80,24],[89,27,80,25,"initialRole"],[89,38,80,36],[89,39,80,37],[90,8,81,6],[90,14,81,12,"AsyncStorage"],[90,26,81,24],[90,27,81,24,"default"],[90,34,81,24],[90,35,81,25,"setItem"],[90,42,81,32],[90,43,81,33],[90,56,81,46],[90,58,81,48,"initialRole"],[90,69,81,59],[90,70,81,60],[91,6,82,4],[92,4,83,2],[92,5,83,3],[93,4,85,2],[93,10,85,8,"logout"],[93,16,85,14],[93,19,85,17],[93,25,85,17,"logout"],[93,26,85,17],[93,31,85,29],[94,6,86,4],[94,12,86,10,"AsyncStorage"],[94,24,86,22],[94,25,86,22,"default"],[94,32,86,22],[94,33,86,23,"removeItem"],[94,43,86,33],[94,44,86,34],[94,56,86,46],[94,57,86,47],[95,6,87,4],[95,12,87,10,"AsyncStorage"],[95,24,87,22],[95,25,87,22,"default"],[95,32,87,22],[95,33,87,23,"removeItem"],[95,43,87,33],[95,44,87,34],[95,57,87,47],[95,58,87,48],[96,6,88,4,"setUser"],[96,13,88,11],[96,14,88,12],[96,18,88,16],[96,19,88,17],[97,6,89,4,"setActiveRoleState"],[97,24,89,22],[97,25,89,23],[97,29,89,27],[97,30,89,28],[98,4,90,2],[98,5,90,3],[99,4,92,2],[99,10,92,8,"setActiveRole"],[99,23,92,21],[99,26,92,24],[99,32,92,31,"role"],[99,36,92,43],[99,40,92,48],[100,6,93,4],[100,10,93,8,"user"],[100,14,93,12],[100,18,93,16,"user"],[100,22,93,20],[100,23,93,21,"roles"],[100,28,93,26],[100,29,93,27,"includes"],[100,37,93,35],[100,38,93,36,"role"],[100,42,93,40],[100,43,93,41],[100,45,93,43],[101,8,94,6,"setActiveRoleState"],[101,26,94,24],[101,27,94,25,"role"],[101,31,94,29],[101,32,94,30],[102,8,95,6],[102,14,95,12,"AsyncStorage"],[102,26,95,24],[102,27,95,24,"default"],[102,34,95,24],[102,35,95,25,"setItem"],[102,42,95,32],[102,43,95,33],[102,56,95,46],[102,58,95,48,"role"],[102,62,95,52],[102,63,95,53],[103,6,96,4],[104,4,97,2],[104,5,97,3],[105,4,99,2],[105,24,100,4],[105,28,100,4,"_reactJsxDevRuntime"],[105,47,100,4],[105,48,100,4,"jsxDEV"],[105,54,100,4],[105,56,100,5,"AuthContext"],[105,67,100,16],[105,68,100,17,"Provider"],[105,76,100,25],[106,6,101,6,"value"],[106,11,101,11],[106,13,101,13],[107,8,102,8,"user"],[107,12,102,12],[108,8,103,8,"loading"],[108,15,103,15],[109,8,104,8,"activeRole"],[109,18,104,18],[110,8,105,8,"signup"],[110,14,105,14],[111,8,106,8,"login"],[111,13,106,13],[112,8,107,8,"logout"],[112,14,107,14],[113,8,108,8,"setActiveRole"],[114,6,109,6],[114,7,109,8],[115,6,109,8,"children"],[115,14,109,8],[115,16,111,7,"children"],[116,4,111,15],[117,6,111,15,"fileName"],[117,14,111,15],[117,16,111,15,"_jsxFileName"],[117,28,111,15],[118,6,111,15,"lineNumber"],[118,16,111,15],[119,6,111,15,"columnNumber"],[119,18,111,15],[120,4,111,15],[120,11,112,26],[120,12,112,27],[121,2,114,0],[121,3,114,1],[122,2,116,7],[122,8,116,13,"useAuth"],[122,15,116,20],[122,18,116,23,"useAuth"],[122,19,116,23],[122,24,116,29],[123,4,117,2],[123,10,117,8,"context"],[123,17,117,15],[123,20,117,18],[123,24,117,18,"useContext"],[123,30,117,28],[123,31,117,28,"useContext"],[123,41,117,28],[123,43,117,29,"AuthContext"],[123,54,117,40],[123,55,117,41],[124,4,118,2],[124,8,118,6],[124,9,118,7,"context"],[124,16,118,14],[124,18,118,16],[125,6,119,4],[125,12,119,10],[125,16,119,14,"Error"],[125,21,119,19],[125,22,119,20],[125,64,119,62],[125,65,119,63],[126,4,120,2],[127,4,121,2],[127,11,121,9,"context"],[127,18,121,16],[128,2,122,0],[128,3,122,1],[129,0,122,2],[129,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadUser","signup","login","logout","setActiveRole","useAuth"],"mappings":"AAA;qECiB;YCM;GDE;mBEE;GF0B;iBGE;GHW;gBIE;GJc;iBKE;GLK;wBME;GNK;CDiB;uBQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}